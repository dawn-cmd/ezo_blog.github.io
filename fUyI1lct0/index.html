<html>
  <head>
    <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Edmonds-Karp Algorithm | ezo&#39;s blog</title>
<meta name="description" content="People who know nothing repeat it.
" />
<link rel="shortcut icon" href="https://dawn-cmd.github.io/favicon.ico">
<link rel="stylesheet" href="https://dawn-cmd.github.io/styles/main.css">

<script src="https://dawn-cmd.github.io/media/js/jquery.min.js"></script>
<script src="https://dawn-cmd.github.io/media/js/masonry.pkgd.min.js"></script>
<script src="https://dawn-cmd.github.io/media/js/aos.js"></script>
<script src="https://dawn-cmd.github.io/media/js/pace.min.js"></script>
<script src="https://dawn-cmd.github.io/media/js/view-image.min.js"></script>
<script src="https://dawn-cmd.github.io/media/js/jquery.magnific-popup.min.js"></script>
<script src="https://dawn-cmd.github.io/media/js/functions.js"></script>
    <meta name="referrer" content="never">
    <meta name="description" content="Introduction
In this passage, I will show one of the most classic problems on graph: the network flow problem. The graph..." />
    <meta name="keywords" content="Note" />
    <script src="https://dawn-cmd.github.io/media/js/waterfall.min.js"></script>
    <script src="https://dawn-cmd.github.io/media/js/prism.min.js"></script>
  </head>
  <body>
            <header id="header" class="grid-container">
        <!-- start: .menu-wrapper -->
        <div class="menu-mobile"> 
          <i class="fa fa-reorder"></i>
        </div>
        <div class="menu-wrapper">
          <div class="">
            <div class="logo">
              <a href="https://dawn-cmd.github.io"><img src="/media/images/logoo.png" alt=""></a>
            </div>
            <!-- start: .main-nav -->

            <nav class="main-nav grid-container grid-parent">
              <ul id="menu-header" class="menu gradient-effect">
                <li class=""><a href="https://dawn-cmd.github.io" class="menu">首页</a></li>
                
                  <li class="" >
                    <a href="https://dawn-cmd.github.io" class="menu">
                      Homepage
                    </a>
                  </li>
                
                  <li class="" >
                    <a href="/archives" class="menu">
                      Archives
                    </a>
                  </li>
                
                  <li class="" >
                    <a href="/tags" class="menu">
                      Tags
                    </a>
                  </li>
                
                  <li class="" >
                    <a href="https://dawn-cmd.github.io/aQhyHFZwS" class="menu">
                      About
                    </a>
                  </li>
                
                <li class="search-menu-item hide-on-mobile hide-on-tablet"><a href="#search-lightbox" class="lightbox mfp-inline"><i class="fa fa-search-line"></i></a></li>
              </ul>
            </nav>
            <a href="#search-lightbox" class="lightbox epcl-search-button mfp-inline hide-on-tablet hide-on-desktop"><i class="fa fa-search-line"></i></a>
            <!-- end: .main-nav -->
            <div class="clear"></div>
            <div class="border hide-on-tablet hide-on-mobile"></div>
          </div>    
          <div class="clear"></div>
        </div>
        <!-- end: .menu-wrapper -->
        <div class="clear"></div>
      </header>
      <div class="hide-on-mobile hide-on-tablet hide-on-desktop">
        <div id="search-lightbox" class="grid-container grid-small grid-parent mfp-hide">
          <div class="search-wrapper section">
            <form id="gridea-search-form" data-update="1602079839247" action="/search/index.html" class="search-form" _lpchecked="1">
              <input type="text" name="q" id="s" value="" class="search-field" placeholder="搜点啥..." aria-label="搜点啥..." required="">
              <button type="submit" class="submit" aria-label="Submit">
                <i class="fa fa-search-line"></i>
              </button>
            </form>
          </div>
        </div>
      </div>

      <main id="single" class="main grid-container fullcover no-sidebar aos-init aos-animate" data-aos="fade">

        <div class="center content">
          <div class="featured-image cover" style="background-image: url('https://dawn-cmd.github.io/post-images/fUyI1lct0.jpg');">
            <div class="meta top"> 
              <time class="meta-info" style="float:left;" datetime="2020-10-07"><i class="fa fa-calendar"></i><span class="lately">6 小时前</span></time>
              
              <a href="https://dawn-cmd.github.io/fUyI1lct0/#comments" class="comments meta-info" title="">
                <i class="fa fa-comment remixicon"></i><span class="comment-count valine-comment-count" data-xid="/fUyI1lct0/"> </span>
              </a>
              <span id="/fUyI1lct0/" class="leancloud_visitors views-counter meta-info" title=""><i class="fa fa-leancloud remixicon"></i><span class="leancloud-visitors-count"></span></span>
              
            </div>
            <div class="info">
              <div class="tags ">
                
                      <a href="https://dawn-cmd.github.io/T9dinVrg_/" class="ctag ctag-0 ctag-T9dinVrg_" aria-label="">Note</a>
                    
              </div>
              <h1 class="title ularge white bold">Edmonds-Karp Algorithm</h1>
            </div>
          </div>
        </div>  

        <div class="epcl-page-wrapper">
          <div class="left-content grid-70 np-mobile">
            <article class="main-article post">
              <section class="post-content">
                <div class="text">
                  <h2 id="introduction">Introduction</h2>
<p>In this passage, I will show one of the most classic problems on graph: the network flow problem. The graph is made by several vertexs and edges which have directions and capacities. There exist a source vertex and a sink vertex in the graph. And the problem is to calculate the maximum flow from source vertex to the sink vertex. If you think it is hard to understand, you can consider it as a water pipe system under the ground: In the system, each pipe has a capacity and direction. And the question is to calculate how much water can flow from the source to the sink in a minute.</p>
<h2 id="prerequisite-build-the-graph">Prerequisite: Build the Graph</h2>
<p>In most cases, this part is not mentioned in many other kinds of introduction of other graph algorithms. Because most of them just need a effective way to check the whole graph but do not need to concern the order. Nevertheless, in the network flow problems, we need to attach two antiparallel edges to each other.(I will explain the reason later in the passage.) So I recommend using array to imitate static list but not other data structure. If you use this structure and add a pair of antiparallel edge, you will find their ids in the array are adjacent. Suppose one of edges' id is x. Then, its antiparallel edge's id is x^1. The benefit enables the computer to &quot;regret&quot; when they choose a wrong answer.</p>
<h2 id="step1-find-augmenting-path">Step1: Find Augmenting Path</h2>
<p>Before we formally start coding, let me explain the main idea briefly: Find a augmenting path, add the minimum capacity to the answer, and repeat it until there is no augmenting path. So, what's the augmenting path? Generally speaking, an augmenting path is a feasible way from source to sink. In the first step, we just need to find a augmenting path but do not need to concern its capacity.  We can use BFS to finish this proccess.</p>
<h2 id="step2-add-the-flow">Step2: Add the flow</h2>
<p>Now we have an augmenting path, and then we need to do is subtracting the maximum capacity in the path from each edge's capacity in the path. And here is a point: We also need to add the maximum capacity to all the antiparallel edges' capacity of the path. Why? One edge may be included in different augmenting paths for several times. If the computer choose the edge but it finds out that it put the edge into a wrong augmenting path, choosing the edge's antiparallel edge enables them to regret the choice and recover the original edge.</p>
<h2 id="code">Code</h2>
<pre><code class="language-cpp">#include&lt;bits/stdc++.h&gt;
#define LL long long
using namespace std;
class node{//information of the edge
    public:
        int to;
        int c;
        int nxt;
};
class graph{
    public:
        vector&lt;int&gt; head;
        vector&lt;node&gt; edge;
        vector&lt;int&gt; pre;
        vector&lt;int&gt; incf;
        graph(int a,int s){
            head=vector&lt;int&gt;(a+1);
            pre=vector&lt;int&gt;(a+1);
            incf=vector&lt;int&gt;(a+1);
            incf[s]=2147483647;
            node tmp={0,0,0};
            edge.push_back(tmp);
            edge.push_back(tmp);
        };
};
void addedge(graph &amp;g,int s,int t,int c){
    node tmp={t,c,g.head[s]};
    g.edge.push_back(tmp);
    g.head[s]=g.edge.size()-1;
}
bool augmenting_path(graph &amp;g,int n,int s,int t){
    vector&lt;bool&gt; h=vector&lt;bool&gt;(n+1);//detect the point is visited or not
    queue&lt;int&gt; q;
    q.push(s);
    h[s]=1;
    while(!q.empty()){
        int x=q.front();
        q.pop();
        for(int y,c,i=g.head[x];i;i=g.edge[i].nxt){
            y=g.edge[i].to;
            c=g.edge[i].c;
            if(h[y]||!c)
                continue;
            g.incf[y]=min(g.incf[x],c);
            g.pre[y]=i;
            if(y==t)
                return 1;
            h[y]=1;
            q.push(y);
        }
    } 
    return 0;
}
int increase_flow(graph &amp;g,int s,int t){
    int x=t;
    while(x!=s){
        int i=g.pre[x];
        g.edge[i].c-=g.incf[t];
        g.edge[i^1].c+=g.incf[t];
        x=g.edge[i^1].to;
    }
    return g.incf[t];
}
int main(){
    ios_base::sync_with_stdio(0);
    cin.tie(0);
    cout.tie(0);
    int n;//number of vertexs
    int m;//number of edges
    int s;//source vertex
    int t;//sink vertex
    cin&gt;&gt;n&gt;&gt;m&gt;&gt;s&gt;&gt;t;
    graph g(n,s);
    for(int i=1,a,b,c;i&lt;=m;++i){
        cin&gt;&gt;a&gt;&gt;b&gt;&gt;c;
        addedge(g,a,b,c);
        addedge(g,b,a,0);
    }
    LL ans=0;
    while(augmenting_path(g,n,s,t)){
        ans+=increase_flow(g,s,t);
    }
    cout&lt;&lt;ans&lt;&lt;endl;
    return 0;
}
</code></pre>
<h2 id="notice">Notice</h2>
<p>This algorithm is, indeed, a semi-finished product. Thus, it is not very effective. It can be used when the number of vertexs is lower than 10,000. But it provides a principle that used in most other network-flow problems. So totally understanding this algorithm will lay a solid fundation for further study.</p>

                </div>
                <div class="clear"></div>
              </section>
            </article>
            <div class="clear"></div>

            <section class="related section">
              
              
              <article class="next grid-50 tablet-grid-50 grid-parent">
                <div class="thumb cover lazy loaded" style="background-image: url('https://dawn-cmd.github.io/post-images/r5xcxY_Zp.gif');"></div>
                 <a href="https://dawn-cmd.github.io/r5xcxY_Zp/" class="full-link"></a>
                 <div class="info">
                  <time datetime="2020-10-02">2020-10-02</time>
                  <h4 class="title white no-margin">Dijkstra Algorithm</h4>
                </div>
                 <span class="epcl-button red">
                  <img src="https://dawn-cmd.github.io/media/images/right-arrow.svg" width="15" alt="Left Arrow">
                </span>
                <div class="overlay"></div>
              </article>
              

                <div class="clear"></div>
            </section>

              <div class="clear"></div>
              
            
              <div id="comments" class="bg-white hosted ">
                
                  <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>

<div id="gitalk-container"></div>
<div class="clear"></div>

<script>
  var gitalk = new Gitalk({
    clientID: 'a557158794a6c9e40381',
    clientSecret: 'bfea67373002d05ed56651f57426652332b138a9',
    repo: 'dawn-cmd.github.io',
    owner: 'dawn-cmd',
    admin: ['dawn-cmd'],
    id: (location.pathname).substring(0, 49),      // Ensure uniqueness and length less than 50
    distractionFreeMode: false  // Facebook-like distraction free mode
  })

  gitalk.render('gitalk-container')
</script>

                
                
              </div>
            

            </div>
          </div>
      </main>

          <footer id="footer" class="grid-container">
        <div class="widgets row gradient-effect">
            <div class="default-sidebar border-effect">
              <div class="grid-33 tablet-grid-50 mobile-grid-100">
                <section id="tag_cloud-2" class="widget widget_epcl_posts_thumbs underline-effect">
                  <h4 class="widget-title title white bordered">最新文章</h4>
                  
                  
                  <article class="item post-0 post type-post status-publish format-standard has-post-thumbnail hentry">
                    <a href="https://dawn-cmd.github.io/fUyI1lct0/" class="thumb hover-effect">
                      <span class="fullimage cover" style="display:block;border-radius:50%;background-image: url('https://dawn-cmd.github.io/post-images/fUyI1lct0.jpg');"></span>
                    </a>
                    <div class="info gradient-effect">
                      <time datetime="2020-10-07">2020-10-07</time>
                      <h4 class="title usmall">
                        <a href="https://dawn-cmd.github.io/fUyI1lct0/">Edmonds-Karp Algorithm</a>
                      </h4>
                    </div>
                    <div class="clear"></div>
                  </article>
                  
                  
                  
                  <article class="item post-1 post type-post status-publish format-standard has-post-thumbnail hentry">
                    <a href="https://dawn-cmd.github.io/r5xcxY_Zp/" class="thumb hover-effect">
                      <span class="fullimage cover" style="display:block;border-radius:50%;background-image: url('https://dawn-cmd.github.io/post-images/r5xcxY_Zp.gif');"></span>
                    </a>
                    <div class="info gradient-effect">
                      <time datetime="2020-10-02">2020-10-02</time>
                      <h4 class="title usmall">
                        <a href="https://dawn-cmd.github.io/r5xcxY_Zp/">Dijkstra Algorithm</a>
                      </h4>
                    </div>
                    <div class="clear"></div>
                  </article>
                  
                  
                  
                  <article class="item post-2 post type-post status-publish format-standard has-post-thumbnail hentry">
                    <a href="https://dawn-cmd.github.io/oYNuWB-VD/" class="thumb hover-effect">
                      <span class="fullimage cover" style="display:block;border-radius:50%;background-image: url('https://news.itmo.ru/images/news/big/917925.jpg');"></span>
                    </a>
                    <div class="info gradient-effect">
                      <time datetime="2020-08-14">2020-08-14</time>
                      <h4 class="title usmall">
                        <a href="https://dawn-cmd.github.io/oYNuWB-VD/">Codeforces Round #663 Div2 retrospect</a>
                      </h4>
                    </div>
                    <div class="clear"></div>
                  </article>
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  <div class="clear"></div>
                </section>
              </div>

              <div class="grid-33 tablet-grid-50 mobile-grid-100">
                <section id="tag_cloud-2" class="widget widget_tag_cloud underline-effect">
                  <h4 class="widget-title title white bordered">标签云</h4>
                  <div class="tagcloud">
                    
                      <a href="https://dawn-cmd.github.io/T9dinVrg_/" class="ctag ctag-0 ctag-T9dinVrg_" aria-label="">Note</a>
                    
                      <a href="https://dawn-cmd.github.io/P8XbJiAxi/" class="ctag ctag-1 ctag-P8XbJiAxi" aria-label="">Contest Retrospect</a>
                    
                      <a href="https://dawn-cmd.github.io/OPRCr9F-Y/" class="ctag ctag-2 ctag-OPRCr9F-Y" aria-label="">Solution</a>
                    
                  </div>
                  <div class="clear"></div>
                </section>
              </div>

              <div class="grid-33 tablet-grid-50 mobile-grid-100">
                <section id="epcl_about-2" class="widget widget_epcl_about underline-effect">
                  <h4 class="widget-title title white bordered">关于我</h4>
                  <div class="avatar">
                    <a href="" class="translate-effect thumb"><span class="fullimage cover" style="background-image: url(https://dawn-cmd.github.io/images/avatar.png);"></span></a>
                  </div>
                  <div class="info">
                    <h4 class="title small author-name gradient-effect no-margin"><a href="">ezo&#39;s blog</a></h4>
                    <p class="founder">People who know nothing repeat it.
</p>
                    <div class="social">
                      
                        
                      
                        
                      
                        
                      
                        
                      
                        
                      
                    </div> 
                  </div>
                  <div class="clear"></div>
                  </section>
              </div>

            </div>
            <div class="clear"></div>
        </div>

        <div class="logo">
          <a href="https://dawn-cmd.github.io"><img src="/media/images/gridea.png" alt=""></a>
        </div>
        <p class="published border-effect">
          ©2019 共 12 篇文章
          <br/>
          Theme <a href="https://gridea.dev/" target="_blank">「breek」</a> Powered by <a href="https://gridea.dev/" target="_blank">「Gridea」</a>
        </p>
        
        <a href="javascript:void(0)" id="back-to-top" class="epcl-button dark" style="display:none">
          <i class="fa fa-arrow"></i>
        </a>
    </footer>
    
    <div class="clear"></div>

        

      
    <script src="https://dawn-cmd.github.io/media/js/functions-post.js"></script>

    </div>
    <!-- end: #wrapper -->
  </body>
</html>
