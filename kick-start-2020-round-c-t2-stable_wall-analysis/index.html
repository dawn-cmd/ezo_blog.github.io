<html>
  <head>
    <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Kick Start 2020 Round C T2 Stable_Wall Analysis | ezo&#39;s blog</title>
<meta name="description" content="People who know nothing repeat it.
" />
<link rel="shortcut icon" href="https://dawn-cmd.github.io/favicon.ico">
<link rel="stylesheet" href="https://dawn-cmd.github.io/styles/main.css">

<script src="https://dawn-cmd.github.io/media/js/jquery.min.js"></script>
<script src="https://dawn-cmd.github.io/media/js/masonry.pkgd.min.js"></script>
<script src="https://dawn-cmd.github.io/media/js/aos.js"></script>
<script src="https://dawn-cmd.github.io/media/js/pace.min.js"></script>
<script src="https://dawn-cmd.github.io/media/js/view-image.min.js"></script>
<script src="https://dawn-cmd.github.io/media/js/jquery.magnific-popup.min.js"></script>
<script src="https://dawn-cmd.github.io/media/js/functions.js"></script>
    <meta name="referrer" content="never">
    <meta name="description" content="
Before the passage
I think the data of this problem should be strengthened. Because of the weak data, many people can s..." />
    <meta name="keywords" content="Solution" />
    <script src="https://dawn-cmd.github.io/media/js/waterfall.min.js"></script>
    <script src="https://dawn-cmd.github.io/media/js/prism.min.js"></script>
  </head>
  <body>
            <header id="header" class="grid-container">
        <!-- start: .menu-wrapper -->
        <div class="menu-mobile"> 
          <i class="fa fa-reorder"></i>
        </div>
        <div class="menu-wrapper">
          <div class="">
            <div class="logo">
              <a href="https://dawn-cmd.github.io"><img src="/media/images/logoo.png" alt=""></a>
            </div>
            <!-- start: .main-nav -->

            <nav class="main-nav grid-container grid-parent">
              <ul id="menu-header" class="menu gradient-effect">
                <li class=""><a href="https://dawn-cmd.github.io" class="menu">首页</a></li>
                
                  <li class="" >
                    <a href="/archives" class="menu">
                      归档
                    </a>
                  </li>
                
                  <li class="" >
                    <a href="/tags" class="menu">
                      标签
                    </a>
                  </li>
                
                  <li class="" >
                    <a href="https://dawn-cmd.github.io/aQhyHFZwS" class="menu">
                      关于
                    </a>
                  </li>
                
                <li class="search-menu-item hide-on-mobile hide-on-tablet"><a href="#search-lightbox" class="lightbox mfp-inline"><i class="fa fa-search-line"></i></a></li>
              </ul>
            </nav>
            <a href="#search-lightbox" class="lightbox epcl-search-button mfp-inline hide-on-tablet hide-on-desktop"><i class="fa fa-search-line"></i></a>
            <!-- end: .main-nav -->
            <div class="clear"></div>
            <div class="border hide-on-tablet hide-on-mobile"></div>
          </div>    
          <div class="clear"></div>
        </div>
        <!-- end: .menu-wrapper -->
        <div class="clear"></div>
      </header>
      <div class="hide-on-mobile hide-on-tablet hide-on-desktop">
        <div id="search-lightbox" class="grid-container grid-small grid-parent mfp-hide">
          <div class="search-wrapper section">
            <form id="gridea-search-form" data-update="1596809222246" action="/search/index.html" class="search-form" _lpchecked="1">
              <input type="text" name="q" id="s" value="" class="search-field" placeholder="搜点啥..." aria-label="搜点啥..." required="">
              <button type="submit" class="submit" aria-label="Submit">
                <i class="fa fa-search-line"></i>
              </button>
            </form>
          </div>
        </div>
      </div>

      <main id="single" class="main grid-container fullcover no-sidebar aos-init aos-animate" data-aos="fade">

        <div class="center content">
          <div class="featured-image cover" style="background-image: url('https://tse1-mm.cn.bing.net/th/id/OIP.zCZvaLblroS943kFj4-tDQHaD4?w=290&amp;h=180&amp;c=7&amp;o=5&amp;dpr=1.38&amp;pid=1.7');">
            <div class="meta top"> 
              <time class="meta-info" style="float:left;" datetime="2020-07-30"><i class="fa fa-calendar"></i><span class="lately">8 天前</span></time>
              
              <a href="https://dawn-cmd.github.io/kick-start-2020-round-c-t2-stable_wall-analysis/#comments" class="comments meta-info" title="">
                <i class="fa fa-comment remixicon"></i><span class="comment-count valine-comment-count" data-xid="/kick-start-2020-round-c-t2-stable_wall-analysis/"> </span>
              </a>
              <span id="/kick-start-2020-round-c-t2-stable_wall-analysis/" class="leancloud_visitors views-counter meta-info" title=""><i class="fa fa-leancloud remixicon"></i><span class="leancloud-visitors-count"></span></span>
              
            </div>
            <div class="info">
              <div class="tags ">
                
                      <a href="https://dawn-cmd.github.io/OPRCr9F-Y/" class="ctag ctag-0 ctag-OPRCr9F-Y" aria-label="">Solution</a>
                    
              </div>
              <h1 class="title ularge white bold">Kick Start 2020 Round C T2 Stable_Wall Analysis</h1>
            </div>
          </div>
        </div>  

        <div class="epcl-page-wrapper">
          <div class="left-content grid-70 np-mobile">
            <article class="main-article post">
              <section class="post-content">
                <div class="text">
                  <!-- more -->
<h2 id="before-the-passage">Before the passage</h2>
<p>I think the data of this problem should be strengthened. Because of the weak data, many people can solve the problem via a very stupid way(<s>me</s>). the details will be furnished in the following passage. However, the ratio of people who passed the problem is lower than the one in other contemporary rounds, it is unbelievable.</p>
<h2 id="official-link">Official link</h2>
<p><a href="https://codingcompetitions.withgoogle.com/kickstart/round/000000000019ff43/00000000003379bb">Here</a></p>
<h2 id="problem">Problem</h2>
<p>Apollo is playing a game involving polyominos. A polyomino is a shape made by joining together one or more squares edge to edge to form a single connected shape. The game involves combining N polyominos into a single rectangular shape without any holes. Each polyomino is labeled with a unique character from A to Z.</p>
<p>Apollo has finished the game and created a rectangular wall containing R rows and C columns. He took a picture and sent it to his friend Selene. Selene likes pictures of walls, but she likes them even more if they are stable walls. A wall is stable if it can be created by adding polyominos one at a time to the wall so that each polyomino is always supported. A polyomino is supported if each of its squares is either on the ground, or has another square below it.</p>
<p>Apollo would like to check if his wall is stable and if it is, prove that fact to Selene by telling her the order in which he added the polyominos.</p>
<h2 id="input">Input</h2>
<p>The first line of the input gives the number of test cases, T. T test cases follow. Each test case begins with a line containing the two integers R and C. Then, R lines follow, describing the wall from top to bottom. Each line contains a string of C uppercase characters from A to Z, describing that row of the wall.</p>
<h2 id="output">Output</h2>
<p>For each test case, output one line containing Case #x: y, where x is the test case number (starting from 1) and y is a string of N uppercase characters, describing the order in which he built them. If there is more than one such order, output any of them. If the wall is not stable, output -1 instead.</p>
<h2 id="limits">Limits</h2>
<p>Time limit: 20 seconds per test set.<br>
Memory limit: 1GB.<br>
1 ≤ T ≤ 100.<br>
1 ≤ R ≤ 30.<br>
1 ≤ C ≤ 30.<br>
No two polyominos will be labeled with the same letter.<br>
The input is guaranteed to be valid according to the rules described in the statement.</p>
<h2 id="test-set-1">Test set 1</h2>
<p>1 ≤ N ≤ 5.</p>
<h2 id="test-set-2">Test set 2</h2>
<p>1 ≤ N ≤ 26.</p>
<h2 id="sample">Sample</h2>
<h3 id="input-2">Input</h3>
<p>4</p>
<p>4 6</p>
<p>ZOAAMM</p>
<p>ZOAOMM</p>
<p>ZOOOOM</p>
<p>ZZZZOM</p>
<p>4 4</p>
<p>XXOO</p>
<p>XFFO</p>
<p>XFXO</p>
<p>XXXO</p>
<p>5 3</p>
<p>XXX</p>
<p>XPX</p>
<p>XXX</p>
<p>XJX</p>
<p>XXX</p>
<p>3 10</p>
<p>AAABBCCDDE</p>
<p>AABBCCDDEE</p>
<p>AABBCCDDEE</p>
<h3 id="output-2">Output</h3>
<p>Case #1: ZOAM</p>
<p>Case #2: -1</p>
<p>Case #3: -1</p>
<p>Case #4: EDCBA</p>
<h3 id="explainatoin">Explainatoin</h3>
<p>In sample case #1, note that ZOMA is another possible answer.</p>
<p>In sample case #2 and sample case #3, the wall is not stable, so the answer is -1.</p>
<p>In sample case #4, the only possible answer is EDCBA.</p>
<h2 id="analysis">Analysis</h2>
<ol>
<li>
<p>O(n!) solution:We can list all the possible order that the polyominos being set in and then check them one by one.</p>
</li>
<li>
<p>O(n to n!) solution:<s>this is the stupid way</s>When I was solving the problem, I used DFS technique(Deep-First-Search) to address it. Specifically, I imitated the process of setting polyomino: I determined which polyomino I should put one by one, when there exist problems, we back to the previous step and try another way. Because N is specially small, this solution can be accepted narrowly.</p>
</li>
<li>
<p>O(R * C) solution:So this is the best solution. Literally, when a polyomino is totally or partly above another polyomino, the upper one should be set after the lower one restrictly. When it happpens, we can consider these two polyominos as two vertexs, and build an edge directed from the lower one to the upper one. We proceed all the polyominos by this way, in the end, we can get a graph. All we need to do is to find a topological sort of the graph. About topological sort, if you do not know it very well, <a href="https://dawn-cmd.github.io/o_E2mKnup/">this passage</a> may help you.</p>
</li>
</ol>
<h2 id="code-of-my-solution">Code of my solution</h2>
<pre><code class="language-cpp">#include&lt;bits/stdc++.h&gt;
using namespace std;
int T;
int r;
int c;
string ans;
string mp[31];
string lit;
map&lt;char,int&gt; h;
bool check(){
    for(int i=1;i&lt;r;++i){
        for(int j=0;j&lt;c;++j){
            if(h[mp[i][j]]==0&amp;&amp;h[mp[i-1][j]]==1){
                return 0;
            }
        }
    }
    return 1;
}
void dfs(string now){
    if(now.length()==lit.length()){
        ans=now;
        return;
    }
    if(ans!=&quot;-1&quot;){
        return;
    }
    for(int i=0;i&lt;lit.length();++i){
        if(h[lit[i]]==1){
            continue;
        }
        h[lit[i]]=1;
        if(check()){
            dfs(now+lit[i]);
        }
        h[lit[i]]=0; 
    } 
}
int main(){
    cin&gt;&gt;T;
    for(int P=1;P&lt;=T;++P){
        cin&gt;&gt;r&gt;&gt;c;
        lit=&quot;&quot;;
        h.erase(h.begin(),h.end());
        for(int i=0;i&lt;r;++i){
            cin&gt;&gt;mp[i];
            for(int j=0;j&lt;c;++j){
                if(h[mp[i][j]]==0){
                    h[mp[i][j]]=1;
                    lit+=mp[i][j];
                }
            }
        }
        h.erase(h.begin(),h.end());
        ans=&quot;-1&quot;;
        dfs(&quot;&quot;);
        cout&lt;&lt;&quot;Case #&quot;&lt;&lt;P&lt;&lt;&quot;: &quot;&lt;&lt;ans&lt;&lt;endl;
    }
    return 0;
}
</code></pre>
<h2 id="code-of-the-best-solution">Code of the best solution</h2>
<pre><code class="language-cpp">#include&lt;bits/stdc++.h&gt;
using namespace std;
int r;
int c;
string mp[1000];
vector&lt;int&gt; graph[1000];
int incnt[1000];
int n;
string ans;
map&lt;char,int&gt; h;
void topo(){
    queue&lt;int&gt; q;
    for(int i=1;i&lt;=30;++i){
        if(incnt[i]==0&amp;&amp;h[(char)(i+'A'-1)]){
            q.push(i);
        }
    }
    while(!q.empty()){
        int x=q.front();
        ans+=(char)(x+'A'-1);
        q.pop();
        for(int i=0;i&lt;graph[x].size();++i){
            int y=graph[x][i];
            incnt[y]--;
            if(incnt[y]==0){
                q.push(y);
            }
        }
    }
    return;
}
int main(){
    int T;
    cin&gt;&gt;T;
    for(int P=1;P&lt;=T;++P){
        cin&gt;&gt;r&gt;&gt;c;
        n=0;
        h.erase(h.begin(),h.end());
        for(int i=0;i&lt;r;++i){
            cin&gt;&gt;mp[i];
            for(int j=0;j&lt;c;++j){
                if(h[mp[i][j]]==0){
                    h[mp[i][j]]=1;
                    ++n;
                }
            }
        }
        memset(incnt,0,sizeof incnt);
        map&lt;pair&lt;int,int&gt;,int&gt; he;
        for(int i=1;i&lt;=30;++i){
            graph[i].clear();
        }
        for(int i=1;i&lt;r;++i){
            for(int j=0;j&lt;c;++j){
                if(mp[i][j]!=mp[i-1][j]){
                    int x=mp[i][j]-'A'+1;
                    int y=mp[i-1][j]-'A'+1;
                    if(he[make_pair(x,y)]==0){
                        graph[x].push_back(y);
                        he[make_pair(x,y)]=1;
                        ++incnt[y];
                    } 
                }
            }
        }
        ans=&quot;&quot;;
        topo();
        if(ans.length()&lt;n){
            cout&lt;&lt;&quot;Case #&quot;&lt;&lt;P&lt;&lt;&quot;: &quot;&lt;&lt;&quot;-1&quot;&lt;&lt;endl;
        }
        else{
            cout&lt;&lt;&quot;Case #&quot;&lt;&lt;P&lt;&lt;&quot;: &quot;&lt;&lt;ans&lt;&lt;endl;
        }
    }
    return 0;
}
</code></pre>

                </div>
                <div class="clear"></div>
              </section>
            </article>
            <div class="clear"></div>

            <section class="related section">
              
              <article class="prev grid-50 tablet-grid-50 grid-parent">
                <div class="thumb cover lazy loaded" style="background-image: url('https://tse1-mm.cn.bing.net/th/id/OIP.zCZvaLblroS943kFj4-tDQHaD4?w=290&amp;h=180&amp;c=7&amp;o=5&amp;dpr=1.38&amp;pid=1.7');"></div>
                 <a href="https://dawn-cmd.github.io/kick-start-2020-round-c-t1-countdown-analysis/" class="full-link"></a>
                 <div class="info">
                  <time datetime="2020-07-30">2020-07-30</time>
                  <h4 class="title white no-margin">Kick Start 2020 Round C T1 Countdown Analysis</h4>
                </div>
                 <span class="epcl-button red">
                  <img src="https://dawn-cmd.github.io/media/images/left-arrow.svg" width="15" alt="Left Arrow">
                </span>
                <div class="overlay"></div>
              </article>
              
              

                <div class="clear"></div>
            </section>

              <div class="clear"></div>
              
            
              <div id="comments" class="bg-white hosted ">
                
                  <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>

<div id="gitalk-container"></div>
<div class="clear"></div>

<script>
  var gitalk = new Gitalk({
    clientID: 'a557158794a6c9e40381',
    clientSecret: 'bfea67373002d05ed56651f57426652332b138a9',
    repo: 'dawn-cmd.github.io',
    owner: 'dawn-cmd',
    admin: ['dawn-cmd'],
    id: (location.pathname).substring(0, 49),      // Ensure uniqueness and length less than 50
    distractionFreeMode: false  // Facebook-like distraction free mode
  })

  gitalk.render('gitalk-container')
</script>

                
                
              </div>
            

            </div>
          </div>
      </main>

          <footer id="footer" class="grid-container">
        <div class="widgets row gradient-effect">
            <div class="default-sidebar border-effect">
              <div class="grid-33 tablet-grid-50 mobile-grid-100">
                <section id="tag_cloud-2" class="widget widget_epcl_posts_thumbs underline-effect">
                  <h4 class="widget-title title white bordered">最新文章</h4>
                  
                  
                  <article class="item post-0 post type-post status-publish format-standard has-post-thumbnail hentry">
                    <a href="https://dawn-cmd.github.io/BKt7ppc1X/" class="thumb hover-effect">
                      <span class="fullimage cover" style="display:block;border-radius:50%;background-image: url('https://news.itmo.ru/images/news/big/917925.jpg');"></span>
                    </a>
                    <div class="info gradient-effect">
                      <time datetime="2020-08-07">2020-08-07</time>
                      <h4 class="title usmall">
                        <a href="https://dawn-cmd.github.io/BKt7ppc1X/">Codeforces Round #661 Div3 retrospect</a>
                      </h4>
                    </div>
                    <div class="clear"></div>
                  </article>
                  
                  
                  
                  <article class="item post-1 post type-post status-publish format-standard has-post-thumbnail hentry">
                    <a href="https://dawn-cmd.github.io/cJ22lJu5P/" class="thumb hover-effect">
                      <span class="fullimage cover" style="display:block;border-radius:50%;background-image: url('https://tse1-mm.cn.bing.net/th/id/OIP.zCZvaLblroS943kFj4-tDQHaD4?w=290&amp;h=180&amp;c=7&amp;o=5&amp;dpr=1.38&amp;pid=1.7');"></span>
                    </a>
                    <div class="info gradient-effect">
                      <time datetime="2020-08-03">2020-08-03</time>
                      <h4 class="title usmall">
                        <a href="https://dawn-cmd.github.io/cJ22lJu5P/">Kick Start 2020 Round D T2 Alien Piano Analysis</a>
                      </h4>
                    </div>
                    <div class="clear"></div>
                  </article>
                  
                  
                  
                  <article class="item post-2 post type-post status-publish format-standard has-post-thumbnail hentry">
                    <a href="https://dawn-cmd.github.io/76NaE9Spv/" class="thumb hover-effect">
                      <span class="fullimage cover" style="display:block;border-radius:50%;background-image: url('https://tse1-mm.cn.bing.net/th/id/OIP.zCZvaLblroS943kFj4-tDQHaD4?w=290&amp;h=180&amp;c=7&amp;o=5&amp;dpr=1.38&amp;pid=1.7');"></span>
                    </a>
                    <div class="info gradient-effect">
                      <time datetime="2020-08-02">2020-08-02</time>
                      <h4 class="title usmall">
                        <a href="https://dawn-cmd.github.io/76NaE9Spv/">Kick Start 2020 Round D T1 Record Breaker Analysis</a>
                      </h4>
                    </div>
                    <div class="clear"></div>
                  </article>
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  <div class="clear"></div>
                </section>
              </div>

              <div class="grid-33 tablet-grid-50 mobile-grid-100">
                <section id="tag_cloud-2" class="widget widget_tag_cloud underline-effect">
                  <h4 class="widget-title title white bordered">标签云</h4>
                  <div class="tagcloud">
                    
                      <a href="https://dawn-cmd.github.io/P8XbJiAxi/" class="ctag ctag-0 ctag-P8XbJiAxi" aria-label="">Contest Retrospect</a>
                    
                      <a href="https://dawn-cmd.github.io/OPRCr9F-Y/" class="ctag ctag-1 ctag-OPRCr9F-Y" aria-label="">Solution</a>
                    
                      <a href="https://dawn-cmd.github.io/T9dinVrg_/" class="ctag ctag-2 ctag-T9dinVrg_" aria-label="">Note</a>
                    
                  </div>
                  <div class="clear"></div>
                </section>
              </div>

              <div class="grid-33 tablet-grid-50 mobile-grid-100">
                <section id="epcl_about-2" class="widget widget_epcl_about underline-effect">
                  <h4 class="widget-title title white bordered">关于我</h4>
                  <div class="avatar">
                    <a href="" class="translate-effect thumb"><span class="fullimage cover" style="background-image: url(https://dawn-cmd.github.io/images/avatar.png);"></span></a>
                  </div>
                  <div class="info">
                    <h4 class="title small author-name gradient-effect no-margin"><a href="">ezo&#39;s blog</a></h4>
                    <p class="founder">People who know nothing repeat it.
</p>
                    <div class="social">
                      
                        
                      
                        
                      
                        
                      
                        
                      
                        
                      
                    </div> 
                  </div>
                  <div class="clear"></div>
                  </section>
              </div>

            </div>
            <div class="clear"></div>
        </div>

        <div class="logo">
          <a href="https://dawn-cmd.github.io"><img src="/media/images/gridea.png" alt=""></a>
        </div>
        <p class="published border-effect">
          ©2019 共 8 篇文章
          <br/>
          Theme <a href="https://gridea.dev/" target="_blank">「breek」</a> Powered by <a href="https://gridea.dev/" target="_blank">「Gridea」</a>
        </p>
        
        <a href="javascript:void(0)" id="back-to-top" class="epcl-button dark" style="display:none">
          <i class="fa fa-arrow"></i>
        </a>
    </footer>
    
    <div class="clear"></div>

        

      
    <script src="https://dawn-cmd.github.io/media/js/functions-post.js"></script>

    </div>
    <!-- end: #wrapper -->
  </body>
</html>
